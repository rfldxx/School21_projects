#include <check.h>
#include <stdio.h>

#include "check.h"

static s21_decimal num1[] = {
    {{0x00000000, 0x00000000, 0x00000000, 0x00000000}},
    {{0x00000000, 0x00000000, 0x00000000, 0x80010000}},
    {{0x00000001, 0x00000000, 0x00000000, 0x800E0000}},
    {{0x00000019, 0x00000000, 0x00000000, 0x00010000}},
    {{0x00000183, 0x00000000, 0x00000000, 0x00020000}},
    {{0x14490831, 0x00048E23, 0x00000000, 0x00070000}},
    {{0x00000001, 0x00000000, 0x00000000, 0x00000000}},
    {{0x000F4240, 0x00000000, 0x00000000, 0x001C0000}},
    {{0x00000000, 0x00000000, 0x00000000, 0x000E0000}},
    {{0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0x00000000}},
    {{0x1422CF6C, 0x000001FC, 0x00000000, 0x80030000}},
    {{0x2564B1EA, 0x3927F1F3, 0x041C50D7, 0x000B0000}},
    {{0x0001869F, 0x00000000, 0x00000000, 0x00050000}},
    {{0x000035A3, 0x00000000, 0x00000000, 0x00170000}},
};

static s21_decimal num2[] = {
    {{0x00000000, 0x00000000, 0x00000000, 0x00000000}},
    {{0x00000000, 0x00000000, 0x00000000, 0x00000000}},
    {{0x00000006, 0x00000000, 0x00000000, 0x000F0000}},
    {{0x00000064, 0x00000000, 0x00000000, 0x00000000}},
    {{0x00004DA6, 0x00000000, 0x00000000, 0x00020000}},
    {{0x164214B7, 0x00000028, 0x00000000, 0x00040000}},
    {{0x00000019, 0x00000000, 0x00000000, 0x00010000}},
    {{0x000186A0, 0x00000000, 0x00000000, 0x00140000}},
    {{0x00000000, 0x00000000, 0x00000000, 0x001C0000}},
    {{0x00000000, 0x00000000, 0x00000000, 0x000A0000}},
    {{0xF96C01C5, 0x0007B6B6, 0x00000000, 0x800B0000}},
    {{0x00033F4A, 0x00000000, 0x00000000, 0x000C0000}},
    {{0x00000001, 0x00000000, 0x00000000, 0x00050000}},
    {{0x0001F8A8, 0x00000000, 0x00000000, 0x00030000}},
};

static s21_decimal result[] = {
    {{0x00000000, 0x00000000, 0x00000000, 0x00000000}},
    {{0x00000000, 0x00000000, 0x00000000, 0x00010000}},
    {{0x00000004, 0x00000000, 0x00000000, 0x800F0000}},
    {{0x00000401, 0x00000000, 0x00000000, 0x00010000}},
    {{0x00004F29, 0x00000000, 0x00000000, 0x00020000}},
    {{0x0669F309, 0x00052ABA, 0x00000000, 0x00070000}},
    {{0x00000023, 0x00000000, 0x00000000, 0x00010000}},
    {{0x4E81E240, 0x00000918, 0x00000000, 0x001C0000}},
    {{0x00000000, 0x00000000, 0x00000000, 0x001C0000}},
    {{0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0x00000000}},
    {{0x3015EDC5, 0xD46A37C7, 0x0000000B, 0x800B0000}},
    {{0x75F2326E, 0x3B8F737F, 0x291B2868, 0x000C0000}},
    {{0x000186A0, 0x00000000, 0x00000000, 0x00050000}},
    {{0x828035A3, 0x3C3F28D0, 0x000AAFBF, 0x00170000}},
};

static s21_decimal err_num1[] = {
    {{0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0x00000000}},
    {{0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0x00000000}},
    {{0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0x00010000}},
    {{0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0x00020000}},
    {{0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0x80000000}},
    {{0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0x80000000}},
    {{0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0x80040000}},
};

static s21_decimal err_num2[] = {
    {{0x00000006, 0x00000000, 0x00000000, 0x00010000}},
    {{0x00000001, 0x00000000, 0x00000000, 0x00000000}},
    {{0xFFF0BDBF, 0xFFFFFFFF, 0xFFFFFFFF, 0x00000000}},
    {{0xFFFE7906, 0xFFFFFFFF, 0xFFFFFFFF, 0x00000000}},
    {{0x00000007, 0x00000000, 0x00000000, 0x80010000}},
    {{0x0000000A, 0x00000000, 0x00000000, 0x80010000}},
    {{0xFF67697F, 0xFFFFFFFF, 0xFFFFFFFF, 0x80000000}},
};

static int err_result[] = {
    1, 1, 1, 1, 2, 2, 2,
};


START_TEST(test) {
  for (size_t i = 0; i < sizeof(num1) / sizeof(s21_decimal); ++i) {
    s21_decimal tmp;
    int ret = s21_add(num1[i], num2[i], &tmp);
    check_decimal(tmp, result[i]);
    ck_assert_int_eq(ret, 0);
  }
}
END_TEST

START_TEST(error_test) {
  for (size_t i = 0; i < sizeof(err_num1) / sizeof(s21_decimal); ++i) {
    s21_decimal tmp;
    int ret = s21_add(err_num1[i], err_num2[i], &tmp);
      if (!ret) check_decimal(tmp, result[i]);
    ck_assert_int_eq(ret, err_result[i]);
  }
}
END_TEST

Suite *Create_suite_s21_add() {
  Suite *suite = suite_create("s21_decimal_add tests");
  TCase *tcase_core = tcase_create("Core");
  tcase_add_test(tcase_core, test);
  tcase_add_test(tcase_core, error_test);
  suite_add_tcase(suite, tcase_core);
  return suite;
}
