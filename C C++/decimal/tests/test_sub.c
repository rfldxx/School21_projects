#include <check.h>
#include <stdio.h>

#include "s21_decimal.h"

static s21_decimal num1[] = {
    {{0x00000019, 0x00000000, 0x00000000, 0x00010000}},
    {{0x00000000, 0x00000000, 0x00000000, 0x00000000}},
    {{0x00000000, 0x00000000, 0x00000000, 0x80010000}},
    {{0x00000001, 0x00000000, 0x00000000, 0x800E0000}},
    {{0x14490831, 0x00048E23, 0x00000000, 0x00070000}},
    {{0x00000001, 0x00000000, 0x00000000, 0x00000000}},
    {{0x80000000, 0x80000000, 0x80000000, 0x801C0000}},
    {{0x80000000, 0x80000000, 0x80000000, 0x000E0000}},
    {{0x00000001, 0x00000000, 0x00000000, 0x001C0000}},
    {{0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0x00000000}},
    {{0x1422CF6C, 0x000001FC, 0x00000000, 0x80030000}},
    {{0x2564B1EA, 0x3927F1F3, 0x041C50D7, 0x000B0000}},
    {{0x0001869F, 0x00000000, 0x00000000, 0x00050000}},
    {{0x0098967E, 0x00000000, 0x00000000, 0x80060000}},
    {{0x846A4B4C, 0x0000012A, 0x00000000, 0x00080000}},
    {{0x000035A3, 0x00000000, 0x00000000, 0x00170000}},
    {{0xFFFFFFFD, 0xFFFFFFFF, 0xFFFFFFFF, 0x80000000}},
    {{0xFFFFFFFD, 0xFFFFFFFF, 0xFFFFFFFF, 0x80000000}},
    {{0x25D10992, 0xC0F1C9E2, 0x00000075, 0x000D0000}},
    {{0xCC392EC8, 0x000490A0, 0x00000000, 0x00000000}},
};

static s21_decimal num2[] = {
    {{0x00000019, 0x00000000, 0x00000000, 0x00010000}},
    {{0x00000000, 0x00000000, 0x00000000, 0x00000000}},
    {{0x00000000, 0x00000000, 0x00000000, 0x00000000}},
    {{0x00000006, 0x00000000, 0x00000000, 0x000F0000}},
    {{0x164214B7, 0x00000028, 0x00000000, 0x00040000}},
    {{0x00000019, 0x00000000, 0x00000000, 0x00010000}},
    {{0x80000000, 0x80000000, 0x80000000, 0x801C0000}},
    {{0x80000000, 0x80000000, 0x80000000, 0x000E0000}},
    {{0x00000001, 0x00000000, 0x00000000, 0x001C0000}},
    {{0x00000000, 0x00000000, 0x00000000, 0x000A0000}},
    {{0xF96C01C5, 0x0007B6B6, 0x00000000, 0x800B0000}},
    {{0x00033F4A, 0x00000000, 0x00000000, 0x000C0000}},
    {{0x00000001, 0x00000000, 0x00000000, 0x00050000}},
    {{0x00000002, 0x00000000, 0x00000000, 0x80060000}},
    {{0x0081787B, 0x00000000, 0x00000000, 0x80080000}},
    {{0x0001F8A8, 0x00000000, 0x00000000, 0x00030000}},
    {{0x00000005, 0x00000000, 0x00000000, 0x00010000}},
    {{0x00000033, 0x00000000, 0x00000000, 0x00020000}},
    {{0x2B1BA438, 0x0022C51B, 0x00000000, 0x00060000}},
    {{0x13F6BD6D, 0x1738423E, 0x00000000, 0x000D0000}},
};

static s21_decimal result[] = {
    {{0x00000000, 0x00000000, 0x00000000, 0x00010000}},
    {{0x00000000, 0x00000000, 0x00000000, 0x00000000}},
    {{0x00000000, 0x00000000, 0x00000000, 0x80010000}},
    {{0x00000010, 0x00000000, 0x00000000, 0x800F0000}},
    {{0x22281D59, 0x0003F18C, 0x00000000, 0x00070000}},
    {{0x0000000F, 0x00000000, 0x00000000, 0x80010000}},
    {{0x00000000, 0x00000000, 0x00000000, 0x801C0000}},
    {{0x00000000, 0x00000000, 0x00000000, 0x000E0000}},
    {{0x00000000, 0x00000000, 0x00000000, 0x001C0000}},
    {{0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0x00000000}},
    {{0x3D3DEA3B, 0xD45ACA59, 0x0000000B, 0x800B0000}},
    {{0x75EBB3DA, 0x3B8F737F, 0x291B2868, 0x000C0000}},
    {{0x0001869E, 0x00000000, 0x00000000, 0x00050000}},
    {{0x0098967C, 0x00000000, 0x00000000, 0x80060000}},
    {{0x84EBC3C7, 0x0000012A, 0x00000000, 0x00080000}},
    {{0x827FCA5D, 0x3C3F28D0, 0x000AAFBF, 0x80170000}},
    {{0xFFFFFFFE, 0xFFFFFFFF, 0xFFFFFFFF, 0x80000000}},
    {{0xFFFFFFFE, 0xFFFFFFFF, 0xFFFFFFFF, 0x80000000}},
    {{0x1B79E26E, 0xB810475F, 0x00001443, 0x800D0000}},
    {{0x6E564293, 0x510205DD, 0x29849C5D, 0x000D0000}},
};

static s21_decimal err_num1[] = {
    {{0x00000006, 0x00000000, 0x00000000, 0x80010000}},
    {{0x00000001, 0x00000000, 0x00000000, 0x80000000}},
    {{0x00000001, 0x00000000, 0x00000000, 0x00000000}},
    {{0x0000000A, 0x00000000, 0x00000000, 0x00000000}},
};

static s21_decimal err_num2[] = {
    {{0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0x00000000}},
    {{0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0x00000000}},
    {{0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0x80000000}},
    {{0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0x80000000}},
};

static int err_result[] = {
    2,
    2,
    1,
    1,
};

START_TEST(test) {
  for (size_t i = 0; i < sizeof(num1) / sizeof(s21_decimal); ++i) {
    s21_decimal tmp;
    int ret = s21_sub(num1[i], num2[i], &tmp);
    for (int j = 0; j < 4; j++) {
      ck_assert_int_eq(tmp.bits[j], result[i].bits[j]);
    }
    ck_assert_int_eq(ret, 0);
  }
}
END_TEST

Suite *Create_suite_s21_sub() {
  Suite *suite = suite_create("s21_decimal_sub tests");
  TCase *tcase_core = tcase_create("Core");
  tcase_add_test(tcase_core, test);
  suite_add_tcase(suite, tcase_core);
  return suite;
}